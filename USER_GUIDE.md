# 用户使用指南

## 目录

1. [快速开始](#快速开始)
2. [系统概述](#系统概述)
3. [功能详解](#功能详解)
4. [操作指南](#操作指南)
5. [常见问题](#常见问题)

## 快速开始

### 第一步：启动系统

**Windows 用户**:
1. 双击 `start.bat` 文件
2. 等待环境初始化和服务启动
3. 浏览器会自动打开 http://localhost:3000

**手动启动**:
```bash
# 后端
python backend/app.py

# 前端（新终端）
cd frontend
npm start
```

### 第二步：初始化数据

首次使用时，系统会显示初始化页面：

1. 点击"开始初始化"按钮
2. 等待数据抓取完成（约5-10分钟）
3. 初始化包括：
   - 获取所有中证指数列表
   - 获取近10年国债收益率
   - 获取中证800历史数据
   - 获取最新财务数据

### 第三步：添加自选指数

1. 点击右上角"管理自选"按钮
2. 搜索或浏览指数列表
3. 点击星标图标添加到自选
4. 建议添加5-15个指数

### 第四步：查看决策建议

系统会自动计算并显示：
- 股债配置比例
- 各指数目标仓位
- 加仓/减仓建议

## 系统概述

### 核心理念

本系统基于**股债性价比**和**估值分位数**进行资产配置决策：

1. **股债性价比**决定整体股票配置比例
2. **估值分位数**决定具体指数的权重分配
3. **动态调整**提示加仓减仓时机

### 计算逻辑

#### 1. 股债性价比

```
股债性价比 = 1/中证800市盈率 - 10年国债收益率
```

- **分位数越高** → 股票吸引力越低 → 降低股票配置
- **分位数越低** → 股票吸引力越高 → 增加股票配置

#### 2. 估值分位区间

系统将指数估值分为8个区间，每个区间对应不同的初始分数：

| 分位区间 | 初始分数 | 含义 |
|---------|---------|------|
| 0%-10% | 40 | 极度低估，强烈买入 |
| 10%-20% | 35 | 严重低估，积极买入 |
| 20%-35% | 30 | 低估，可以买入 |
| 35%-50% | 25 | 合理偏低，适度买入 |
| 50%-65% | 20 | 合理偏高，谨慎买入 |
| 65%-80% | 15 | 高估，减少配置 |
| 80%-90% | 10 | 严重高估，考虑减仓 |
| 90%-100% | 5 | 极度高估，建议减仓 |

#### 3. ROE权重调整

```
ROE权重 = 1.0 + (ROE - 10) × 0.1
```

- ROE = 10%时，权重 = 1.0（基准）
- ROE = 15%时，权重 = 1.5（提升50%）
- ROE = 5%时，权重 = 0.5（降低50%）
- ROE ≤ 0或缺失时，权重 = 1.0

#### 4. 综合分数与仓位

```
综合权重 = ROE权重 × 人为权重
综合分数 = 初始分数 × 综合权重
目标仓位 = (该指数综合分数 / 总分) × 股票配置比例
```

## 功能详解

### 1. 仪表盘

#### 股债性价比卡片
- 显示当前股债性价比值
- 中证800市盈率和10年国债收益率
- 近10年分位数（带进度条）

#### 配置建议
- 股票配置比例：建议投入指数基金的资金比例
- 现金配置比例：建议保留的现金或债券比例
- 根据分位数自动生成配置建议文字

#### 背景色变化
- **绿色系**（分位数 < 40%）：股票低估，建议增配
- **黄色系**（分位数 40%-60%）：估值合理，均衡配置
- **红色系**（分位数 > 60%）：股票高估，建议减配

### 2. 指数表格

#### 表格列说明

| 列名 | 说明 |
|-----|------|
| 指数名称 | 指数代码和名称 |
| PE/PB | 市盈率和市净率 |
| ROE | 加权ROE和ROE权重 |
| 分位区间 | 当前估值所在区间（带颜色标识） |
| 综合分数 | 初始分数 × 综合权重 |
| 人为权重 | 可手动调整（点击编辑图标） |
| 目标仓位 | 建议配置的百分比 |
| 操作提示 | 加仓/减仓建议 |

#### 行背景色

- **浅绿色**：建议加仓
- **浅红色**：建议减仓
- **默认色**：持有观望

### 3. 指数选择器

#### 功能
- 搜索指数（按名称或代码）
- 筛选（全部/已自选/未自选）
- 添加/移除自选
- 查看基本估值信息

#### 使用建议
- 选择不同行业/风格的指数以分散风险
- 建议选择5-15个指数
- 优先选择流动性好、跟踪误差小的指数

### 4. 权重调整

#### 调整方法
1. 点击表格中"人为权重"列的编辑图标
2. 输入新的权重值（≥0）
3. 点击保存图标确认

#### 调整建议
- 默认权重为1.0
- 看好某指数可提高权重（如1.5、2.0）
- 不看好可降低权重（如0.5、0.3）
- 完全不想配置可设为0

## 操作指南

### 场景1：首次建仓

**目标**：根据系统建议建立初始仓位

**步骤**：
1. 查看仪表盘的"股票配置比例"
2. 假设可投资金100万，股票配置60%，则投入60万
3. 查看指数表格的"目标仓位"列
4. 按比例分配资金到各指数

**示例**：
```
可投资金：100万
股票配置：60%（60万）

指数A 目标仓位：30% → 18万
指数B 目标仓位：25% → 15万
指数C 目标仓位：20% → 12万
指数D 目标仓位：15% → 9万
指数E 目标仓位：10% → 6万
```

### 场景2：定期调仓

**目标**：根据估值变化调整仓位

**步骤**：
1. 每周或每月查看系统
2. 关注"操作提示"列
3. 有加仓建议时，从现金补充资金
4. 有减仓建议时，卖出部分转为现金

**示例**：
```
指数A：建议加仓5%
当前持仓：18万
建议增持：18万 × 5% = 0.9万

指数B：建议减仓8%
当前持仓：15万
建议减持：15万 × 8% = 1.2万
```

### 场景3：新增资金

**目标**：将新增资金合理分配

**步骤**：
1. 查看当前股票配置比例
2. 按比例分配新增资金
3. 参考目标仓位分配到各指数
4. 优先补充低估值指数

**示例**：
```
新增资金：10万
股票配置：70%
投入股票：7万
保留现金：3万

按目标仓位分配7万到各指数
```

### 场景4：市场大跌

**目标**：判断是否加仓

**步骤**：
1. 查看股债性价比分位数
   - 分位数下降 → 股票吸引力上升
2. 查看各指数分位区间
   - 进入更低区间 → 出现加仓提示
3. 根据风险承受能力决定加仓幅度

**建议**：
- 分位数 < 20%：可大幅加仓
- 分位数 20%-40%：可适度加仓
- 分位数 > 40%：谨慎加仓

### 场景5：市场大涨

**目标**：判断是否减仓

**步骤**：
1. 查看股债性价比分位数
   - 分位数上升 → 股票吸引力下降
2. 查看各指数分位区间
   - 进入更高区间 → 出现减仓提示
3. 逐步减仓，锁定利润

**建议**：
- 分位数 > 80%：建议大幅减仓
- 分位数 60%-80%：可适度减仓
- 分位数 < 60%：继续持有

## 常见问题

### Q1: 为什么有些指数没有ROE数据？

**A**: 可能原因：
1. 指数包含非A股成份股（如港股）
2. 成份股财务数据未更新
3. 新成立指数，历史数据不足

系统会将这些指数的ROE权重设为1.0（中性）。

### Q2: 目标仓位总和不等于100%？

**A**: 目标仓位是指**股票配置部分**的分配比例，不包括现金部分。

示例：
- 股票配置：60%
- 现金配置：40%
- 各指数目标仓位总和 = 100%（指60%中的分配）

### Q3: 什么时候应该刷新数据？

**A**: 
- **自动更新**：每交易日15:30自动执行
- **手动刷新**：
  - 添加新的自选指数后
  - 调整人为权重后
  - 怀疑数据不准确时

### Q4: 如何理解操作提示？

**A**: 
- **加仓**：估值下降，建议增加持仓
- **减仓**：估值上升，建议减少持仓
- **持有**：估值稳定，维持现状

操作百分比表示建议调整的幅度。

### Q5: 人为权重如何设置？

**A**: 
- **1.0**：标准配置，相信系统判断
- **> 1.0**：看好该指数，增加配置
- **< 1.0**：不看好，减少配置
- **0**：完全不配置

建议根据自己的行业判断和风险偏好调整。

### Q6: 系统建议是否一定要执行？

**A**: 
系统提供的是**参考建议**，不是强制指令。您应该：
1. 结合自己的风险承受能力
2. 考虑市场环境和政策变化
3. 参考其他分析工具
4. 做出独立的投资决策

### Q7: 数据多久更新一次？

**A**: 
- **指数行情**：每交易日收盘后
- **财务数据**：每季度财报发布后
- **国债收益率**：每交易日
- **计算指标**：数据更新后自动重算

### Q8: 如何备份数据？

**A**: 
数据库文件位于 `backend/invest.db`，定期复制该文件即可备份。

建议：
- 每周备份一次
- 重大操作前备份
- 保留多个历史版本

### Q9: 可以同时跟踪多个账户吗？

**A**: 
当前版本不支持多账户。如需跟踪多个账户，可以：
1. 部署多个实例
2. 使用Excel记录实际持仓
3. 等待后续版本更新

### Q10: 系统支持哪些指数？

**A**: 
支持所有中证指数，包括但不限于：
- 宽基指数：沪深300、中证500、中证1000
- 行业指数：医药、消费、科技等
- 主题指数：红利、价值、成长等
- 策略指数：低波、质量、动量等

## 投资建议

### 风险提示

1. **历史数据不代表未来**：分位数基于历史数据，市场环境可能改变
2. **系统性风险**：股市整体下跌时，所有指数可能同时下跌
3. **模型局限**：任何模型都有局限性，不能完全预测市场
4. **自主决策**：投资决策应由您自己做出，系统仅供参考

### 使用建议

1. **长期投资**：系统适合长期价值投资，不适合短期交易
2. **分散配置**：选择多个不同行业/风格的指数
3. **定期检视**：每周或每月查看一次即可，不必每天盯盘
4. **纪律执行**：制定投资计划并严格执行
5. **持续学习**：不断学习投资知识，提升判断能力

### 最佳实践

1. **建立投资计划**
   - 确定可投资金额
   - 设定风险承受度
   - 制定调仓规则

2. **定期复盘**
   - 记录每次操作
   - 分析决策得失
   - 优化投资策略

3. **保持理性**
   - 不追涨杀跌
   - 不过度交易
   - 控制情绪波动

4. **持续优化**
   - 根据实际效果调整权重
   - 优化指数选择
   - 改进操作策略

## 技术支持

如遇到问题，请：
1. 查看本文档的常见问题部分
2. 查看 `API_DOCUMENTATION.md` 了解技术细节
3. 查看 `DEPLOYMENT.md` 了解部署问题
4. 检查日志文件排查错误

---

**免责声明**：本系统仅供学习和参考使用，不构成投资建议。投资有风险，决策需谨慎。
