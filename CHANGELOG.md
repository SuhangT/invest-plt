# 更新日志

## [1.1.0] - 2024-10-14

### 🎉 重大更新

#### 数据抓取重试机制
- ✅ **智能重试装饰器**: 添加 `@retry_on_failure` 装饰器，支持自动重试
- ✅ **随机延迟机制**: 每次重试间隔3-10秒随机延迟，避免API频率限制
- ✅ **全面接口覆盖**: 所有数据抓取接口都支持重试（最多10次）
- ✅ **详细日志记录**: 记录每次重试的详细信息，便于监控和调试
- ✅ **可配置参数**: 支持自定义重试次数和延迟时间

#### 新增文档
- 📘 **DATA_FETCHER_GUIDE.md**: 详细的重试机制使用指南
- 📗 **RETRY_MECHANISM_SUMMARY.md**: 重试机制更新总结
- 🧪 **backend/test_retry.py**: 重试机制测试脚本

### 改进

- 🔧 将所有 `time.sleep(self.delay)` 替换为 `self._random_delay()`
- 📝 更新 README.md，添加重试机制说明
- 🐛 修复 `start.bat` 编码问题，改为英文避免乱码

### 性能提升

- 📈 数据抓取成功率预期从 ~70% 提升至 ~95%
- 🛡️ 大幅提高系统稳定性和可靠性
- ⏱️ 智能延迟避免触发API限流

---

## [1.0.0] - 2024-10-13

### 新增功能

#### 核心功能
- ✅ 股债仓位决策系统
  - 基于股债性价比指数计算股票配置比例
  - 近10年分位数动态调整
  - 实时仪表盘展示

- ✅ 指数基金筛选与权重分配
  - 8个估值分位区间梯度评分
  - ROE权重自动计算
  - 人为权重手动调整
  - 综合分数和目标仓位计算

- ✅ 动态操作提示
  - 向上突破触发减仓提示
  - 向下突破触发加仓提示
  - 可视化操作建议展示

#### 数据管理
- ✅ 自动数据抓取
  - 中证指数列表和历史数据
  - 指数成份股及权重
  - 股票财务数据
  - 10年期国债收益率

- ✅ 定时任务
  - 每交易日15:30自动更新
  - 增量数据更新
  - 自动计算指标

#### 用户界面
- ✅ 暗黑主题设计
  - 交易风格配色
  - 响应式布局
  - 移动端适配

- ✅ 交互式可视化
  - 股债性价比仪表盘
  - 分位数进度条
  - 估值区间颜色梯度
  - 操作提示高亮

- ✅ 自选列表管理
  - 快速搜索指数
  - 一键添加/移除
  - 批量管理

#### 技术特性
- ✅ Flask后端API
  - RESTful接口设计
  - SQLite数据库
  - SQLAlchemy ORM

- ✅ React前端
  - 组件化开发
  - TailwindCSS样式
  - Axios数据请求

- ✅ 数据持久化
  - 完整的数据库模型
  - 历史数据存储
  - 计算结果缓存

### 技术栈

#### 后端
- Python 3.8+
- Flask 3.0.0
- SQLAlchemy 3.1.1
- akshare 1.13.0
- APScheduler 3.10.4

#### 前端
- React 18.2.0
- TailwindCSS 3.3.6
- Recharts 2.10.3
- Lucide React 0.294.0
- Axios 1.6.2

### 文档
- ✅ README.md - 项目概述和快速开始
- ✅ USER_GUIDE.md - 详细用户使用指南
- ✅ API_DOCUMENTATION.md - API接口文档
- ✅ DEPLOYMENT.md - 部署和运维指南
- ✅ CHANGELOG.md - 版本更新日志

### 已知问题
- 首次数据初始化时间较长（5-10分钟）
- akshare接口偶尔会有频率限制
- SQLite在高并发下可能出现锁定

### 计划改进
- [ ] 添加用户认证系统
- [ ] 支持多账户管理
- [ ] 添加历史回测功能
- [ ] 优化数据抓取性能
- [ ] 添加更多可视化图表
- [ ] 支持自定义评分规则
- [ ] 添加消息通知功能
- [ ] 支持导出报表

---

## 版本说明

### 版本号规则
- 主版本号：重大架构变更或不兼容更新
- 次版本号：新功能添加
- 修订号：Bug修复和小改进

### 更新频率
- 主版本：按需发布
- 次版本：每月1-2次
- 修订版：按需发布

### 支持政策
- 最新版本：完全支持
- 前一版本：安全更新
- 更早版本：不再支持

---

**注意**：本项目遵循[语义化版本](https://semver.org/lang/zh-CN/)规范。
